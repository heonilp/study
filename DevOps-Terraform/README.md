# DevOps : Infrastructure as Code with 테라폼(Terraform) and AWS 초급, 입문편

[강의](https://www.inflearn.com/course/%EB%8D%B0%EB%B8%8C%EC%98%B5%EC%8A%A4-%ED%85%8C%EB%9D%BC%ED%8F%BC-aws#)

Terraform 101 실습 사이트 : https://terraform101.inflearn.devopsart.dev/

## 4월 20일 ~ 4월 21일 강의 수강, 정리 예정

## 1강 DevOps의 이해

- 데브옵스에 대한 기본개념, 철학

- DevOps : 데브옵스 : 개발과 운영의 합성어, 단순한 개발과 운영의 통합을 의미하는 것은 아님 - 개발과 운영과 간극을 줄이자

- 데브옵스의 5개의 철학 : 문화, 자동화, 측정, 공유, 축적

- 문화 : 사람, 일, 서비스, 자원, 시간

- 자동화 : 인프라 및 보안, 언어 및 도구 ,지속적 통합/배포, 모니터링(장애대응)

- 측정 : 항상측정, 어플리케이션 성능, 개발속도 모니터링 지속적으로 나아지고 아닌지 측정, 의사결정 추측 배제

- 공유 : 문제는 혼자 해결하지않음,  언제든 접근 가능한 투명한 데이터, 지식의 공유, 오픈마인드, 문제발생시 함께 해결, 일의 가속도, 문제는 인턴이 해결할 수도 있음

- 측적 : 효율적으로 1만 시간의 법칙 이루는 것. ex)루이비통

- 정리 : 데브옵스는 어떠한 요구사항을 효율적으로 만족시키기 위해, 일을 자동화하며 변경사항 지표들을 측정하고 공유하고 이 모든 결과물들을 지속적으로 축적해 나가는 문화를 만들어가는 철학 방법론, 기술


## 2강 DevOps 엔지니어의 역할

- 데브옵스의 올바른 개념 기술, 방향성

- 올바른 데브옵스 문화를 위해 서비스 혹은 SW 라이프사이클에서 반복적인 일들을 자동화하고 기술적 문제 혹은 팀의 차이를 기술적으로 예방하고, 해소시키는 사람을 이야기. - 실제로하는 일이 많음

- 데브옵스의 역량의 따라서 할수 있는 역량이 넓어짐, 큰영향을 끼침

- 마케팅, 기획 이런 사람들의 자동화도 데브옵스가 할수 있음

- soft skill : 소통

1. 문제인식 : 문제가 무엇이 있는지 정확하 원인이 뭔지 파악

2. 선택과 집중 : 적합한 방법을 통해 해결, 해결 운선순위 올바르게 설정

3. 결정 : 내 기준이아닌 팀의 기준 서비스의 기준에서 결정해야함, 추측이아닌 확신을 가져야함

4. 업의 속성 : 서비스의 본질과 가치를 이해해야함

5. 사용자 : 사용자를 이해하고 요구사항에 대해서 빠르게 피드백, (실험-> 적용 ->피드백)

- technical skil : 프로그램작성능력, 데이터베이스, 서버관리 수행 등

1. 프로그래밍 능력 : go, Python, Node.js

2. 운영체제 : 리눅스 shell, OS, 파일시스템, 7 layers

3. 서버관리 : 서버를 관리하는 기술과 운영지식, IAC, CI/CD, API, 가용성, 성능 등

4. 오픈소스 : 엔진엑스, 톰켓, MySQL, Redis, Ansible, 테라톰

5. 클라우드 : 퍼블릭클라우드 AWS, 애저 , GCP, 알리바바 등

- OS, 어플리케이션 성능 모니터링, 고가용성 설계, 파이프라인 등 서버관련한 기술

- Infrastructure as Code (IaC) 코드로써의 인프라

- Infrastructure as Code, 즉 코드로써의 인프라는 인프라를 이루는 서버, 미들웨어, 그리고 서비스 등 인프라 구성요소들을 코드를 통해 구축하는 것, IaC는 코드써의 장점, 즉 작성용이성, 재사용성, 유지보수의 장점을 가진다.
- 심도있게 고민해서 작성해야합니다.

- Terraform by Hashicorp(IAC 도구 테라폼)

- 테라폼은 인프라를 만들고, 변경하고, 기록하는 IaC를 위해서 만들어진 도구로써, 문법이 쉬워 비교적 다루기 쉽고 사용자가 매우많아 참고 할수 있는 예제가 많다. AWS, Azure, GCP 같은 퍼블릭 클라우드 뿐만아니라 다양하 서비스에서도 지원한다.

- 우리는 AWS를 사용해서 테라폼의 실습을 진행할 것이다.

## 2강 DevOps 로드맵

- [DevOps 로드맵 사이트](https://roadmap.sh/devops)

- 선형적인 구조를 안따랐으면 좋겠음. 뭐가 중요한건없다. 다 중요하다.

- 데브옵스도 보안적으로 아는 것이 좋다.

- 킵 러닝하는게 좋다.

## 3-1강 테라폼 구성요소

- Infrastructure as Code (IaC) 코드로써의 인프라

- Infrastructure as Code, 즉 코드로써의 인프라는 인프라를 이루는 서버, 미들웨어, 그리고 서비스 등 인프라 구성요소들을 코드를 통해 구축하는 것, IaC는 코드써의 장점, 즉 작성용이성, 재사용성, 유지보수의 장점을 가진다.
- 심도있게 고민해서 작성해야합니다.

- 인지한 순간 적용해야한다.

- 테라폼은 인프라를 만들고, 변경하고, 기록하는 IaC를 위해 만들어진 도구로써 문법이 쉬워서 비교적 다루기 쉽고 사용자가 매우많아서 참고할 수 있는 예제가 많다.

- .tf 형식의 파일 형석을 가진다

- 테라폼의 구성요소

1. provider : 생성할 인프라의 종류를 의미

2. resource : 생성할 인프라 자원

3. state : 생성한 자원의 상태

4. output : 만든 자원을 변수 형태로 state에 저장하는 걸 의미

5. module : 코드를 문자 그대로 모듈형태로 정의

6. remote : 다른 경로의 state를 참조, output 변수를 불러올떄 사용

- 원격 참조 개념으로 이해하면 좋음

- 주니어는 배경, 사상보다 알단 먼저 설치 하고 작성해서 무언가를 만들면서 가까워지자.


## 3-2 테라폼 기본명령어 

- 테라폼 기본명령어부터 똑바로 알자 90%정도 쓰인다.

1. init : 테라폼 명령어 사용을 위해 각종 설정 진행

2. plan : 테라폼으로 작성한 코드가 실제로 어떻게 만들어질지에 대한 예측 결과보여줌

3. apply : 테라폼 코드로 실제 인프라를 생성하는 명령어

4. import : 이미 만들어진 자원을 테라폼 state 파일을 옮겨주는 명령어

5. state : 테라폼 state를 다루는 명령어, 하위 명령어 mv, push와 같은 명령어가 있음

6. destroy : 생성된 자원들 state 파일 모두 삭제하는 명령어(다시 만들떄 사용)


- Terraform Process

1.  init
지정한 backend에 상태 저장을 위한 .tfstate 파일을 생성합니다. 여기에는 가장 마지막에 적용한 테라폼 내역이 저장됩니다.
init 작업을 완료하면, local에는 .tfstate에 정의된 내용을 담은 .terraform 파일이 생성됩니다.
기존에 다른 개발자가 이미 .tfstate에 인프라를 정의해 놓은 것이 있다면, 다른 개발자는 init작업을 통해서 local에 sync를 맞출 수 있습니다.

2.  plan
정의한 코드가 어떤 인프라를 만들게 되는지 미리 예측 결과를 보여줍니다. 단, plan을 한 내용에 에러가 없다고 하더라도, 실제 적용되었을 때는 에러가 발생할 수 있습니다.
Plan 명령어는 어떠한 형상에도 변화를 주지 않습니다. (100% 보장해주지않음)

3.  apply
실제로 인프라를 배포하기 위한 명령어입니다. apply를 완료하면, AWS 상에 실제로 해당 인프라가 생성되고 작업 결과가 backend의 .tfstate 파일에 저장됩니다.
해당 결과는 local의 .terraform 파일에도 저장됩니다.

## 4-1강 AWS EC2 and SSH

- SSH - Secure Shell Protocol : 네트워크 프로토콜 중 하나로 보통 클라이언트와 서버가 인터넷 같은 네트워크를 통해 통신할때, 보안적으로 안전하게 통신을 하기 위해서 상요하는 프로토콜, 보통 패스워드 인증과 RSA 공개키 암호화 방식으로 연결을 함

- EC2 생성, ssh키저장

- netstat -lntp ( ssh 0.0.0.0::22 이 열려있음)

- ps -ef | grep ssh ( ssh 데몬 프로그램이 떠있음 )

- ls -al ->.ssh ->authorized_keys ( 공개키 암호화 방식 )

- 키가 쌍으로 존재, Private 키 ,퍼블릭키가 존재, 서로가 적합한지 확인


## 4-2 강 ZSH 및 Oh-my-zsh 설치

- 강사님은 리눅스환경... 저는 현재 윈도우 환경이니.. putty 사용하고, puttygen 사용해서 pem파일을 바꿈.

- sudo yum install zsh

- sudo yum install util-linux-user.x86_64

- sudo passwd ec2-user 암호 설정해줘야함

- chsh -s /bin/zsh 

- 암호침

- sudo yum install git

- curl -L https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh

- vim ~/.zshrc (테마를 바꿈, ys로 바꿈, 편하게 업무를 볼수 있음)